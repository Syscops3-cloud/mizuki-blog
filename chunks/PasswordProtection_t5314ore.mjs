import { c as createComponent, a as createAstro, d as renderTemplate, g as defineScriptVars, b as addAttribute, m as maybeRenderHead } from './astro/server_CFIJpBV_.mjs';
import { I as I18nKey } from './_astro_content_nJCuh7Be.mjs';
import { i as i18n } from './sakura-manager_BcW8Ox11.mjs';
/* empty css                          */

var __freeze = Object.freeze;
var __defProp = Object.defineProperty;
var __template = (cooked, raw) => __freeze(__defProp(cooked, "raw", { value: __freeze(raw || cooked.slice()) }));
var _a;
const $$Astro = createAstro();
const $$PasswordProtection = createComponent(async ($$result, $$props, $$slots) => {
  const Astro2 = $$result.createAstro($$Astro, $$props, $$slots);
  Astro2.self = $$PasswordProtection;
  const { encryptedContent, passwordHash } = Astro2.props;
  return renderTemplate(_a || (_a = __template(["", '<div id="password-protection" class="password-protection" data-astro-cid-732embm3> <div class="password-container" data-astro-cid-732embm3> <div class="lock-icon" data-astro-cid-732embm3> <svg width="48" height="48" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" data-astro-cid-732embm3> <path d="M18 8h-1V6c0-2.76-2.24-5-5-5S7 3.24 7 6v2H6c-1.1 0-2 .9-2 2v10c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V10c0-1.1-.9-2-2-2zM9 6c0-1.66 1.34-3 3-3s3 1.34 3 3v2H9V6z" fill="currentColor" data-astro-cid-732embm3></path> </svg> </div> <h2 data-astro-cid-732embm3>', "</h2> <p data-astro-cid-732embm3>", '</p> <div class="password-input-group" data-astro-cid-732embm3> <input type="password" id="password-input"', ' class="password-input" data-astro-cid-732embm3> <button id="unlock-btn" class="unlock-button" data-astro-cid-732embm3>', '</button> </div> <div id="error-message" class="error-message" style="display: none;" data-astro-cid-732embm3>', '</div> </div> </div> <div id="decrypted-content" class="decrypted-content" style="display: none;" data-astro-cid-732embm3></div>  <script>(function(){', "\n  // \u5BFC\u5165\u52A0\u5BC6\u5E93 - \u4F7F\u7528\u672C\u5730\u6587\u4EF6\n  async function loadCryptoLibraries() {\n    if (typeof CryptoJS === 'undefined') {\n      await new Promise((resolve, reject) => {\n        const script = document.createElement('script');\n        script.src = '/assets/js/crypto-js.min.js';\n        script.onload = resolve;\n        script.onerror = reject;\n        document.head.appendChild(script);\n      });\n    }\n    \n    if (typeof bcrypt === 'undefined') {\n      await new Promise((resolve, reject) => {\n        const script = document.createElement('script');\n        script.src = '/assets/js/bcrypt.min.js';\n        script.onload = resolve;\n        script.onerror = reject;\n        document.head.appendChild(script);\n      });\n    }\n  }\n\n  // \u52A0\u8F7D\u8BED\u6CD5\u9AD8\u4EAE\u5E93\n  async function loadSyntaxHighlighter() {\n    if (typeof hljs === 'undefined') {\n      await new Promise((resolve, reject) => {\n        const script = document.createElement('script');\n        script.src = '/assets/js/highlight.min.js';\n        script.onload = resolve;\n        script.onerror = reject;\n        document.head.appendChild(script);\n      });\n      await new Promise(resolve => setTimeout(resolve, 100));\n    }\n  }\n\n  // \u4E3A\u4EE3\u7801\u5757\u6DFB\u52A0\u6837\u5F0F\u548C\u529F\u80FD\u7684\u51FD\u6570 - \u4F7F\u7528highlight.js\u8FDB\u884C\u8BED\u6CD5\u9AD8\u4EAE\uFF0C\u4F46\u4F7F\u7528\u5168\u5C40expressive-code\u6837\u5F0F\n  async function enhanceCodeBlocks(container) {\n    // \u52A0\u8F7D\u8BED\u6CD5\u9AD8\u4EAE\u5E93\n    await loadSyntaxHighlighter();\n    \n    const codeBlocks = container.querySelectorAll('pre code');\n    \n    codeBlocks.forEach(codeElement => {\n      const preElement = codeElement.parentElement;\n      if (!preElement) return;\n      \n      // \u83B7\u53D6\u8BED\u8A00\u4FE1\u606F\n      const className = codeElement.className || '';\n      const langMatch = className.match(/language-(\\w+)/);\n      const language = langMatch ? langMatch[1] : 'text';\n      \n      // \u83B7\u53D6\u539F\u59CB\u4EE3\u7801\u6587\u672C\n      const codeText = codeElement.textContent || '';\n      \n      // \u4F7F\u7528 highlight.js \u8FDB\u884C\u8BED\u6CD5\u9AD8\u4EAE\n      let highlightedCode = codeText;\n      if (typeof hljs !== 'undefined') {\n        try {\n          if (language && language !== 'text') {\n            const result = hljs.highlight(codeText, { language: language });\n            highlightedCode = result.value;\n          } else {\n            const result = hljs.highlightAuto(codeText);\n            highlightedCode = result.value;\n          }\n        } catch (e) {\n          console.warn('Syntax highlight failed:', e);\n          highlightedCode = codeText;\n        }\n      }\n      \n      // \u521B\u5EFAexpressive-code\u6837\u5F0F\u7684\u5305\u88C5\u7ED3\u6784\n      const wrapper = document.createElement('div');\n      wrapper.className = 'expressive-code';\n      \n      const frame = document.createElement('div');\n      frame.className = 'frame';\n      \n      // \u521B\u5EFA\u65B0\u7684pre\u5143\u7D20\n      const newPre = document.createElement('pre');\n      newPre.className = 'astro-code';\n      newPre.setAttribute('data-language', language);\n      newPre.setAttribute('tabindex', '0');\n      \n      // \u521B\u5EFA\u65B0\u7684code\u5143\u7D20\n      const newCode = document.createElement('code');\n      newCode.className = `language-${language}`;\n      \n      // \u5C06\u9AD8\u4EAE\u540E\u7684\u4EE3\u7801\u6309\u884C\u5206\u5272\u5E76\u6DFB\u52A0.line\u7C7B\uFF08\u6A21\u62DFexpressive-code\u7684\u884C\u7ED3\u6784\uFF09\n      const lines = highlightedCode.split('\\n');\n      lines.forEach((line, index) => {\n        const lineSpan = document.createElement('span');\n        lineSpan.className = 'line';\n        lineSpan.innerHTML = line || ' '; // \u7A7A\u884C\u4E5F\u8981\u4FDD\u7559\n        newCode.appendChild(lineSpan);\n        \n        // \u9664\u4E86\u6700\u540E\u4E00\u884C\uFF0C\u90FD\u6DFB\u52A0\u6362\u884C\u7B26\n        if (index < lines.length - 1) {\n          newCode.appendChild(document.createTextNode('\\n'));\n        }\n      });\n      \n      newPre.appendChild(newCode);\n      \n      // \u5C06 pre \u4ECE\u539F\u4F4D\u7F6E\u79FB\u9664\u5E76\u91CD\u65B0\u5305\u88C5\n      const parent = preElement.parentNode;\n      parent.insertBefore(wrapper, preElement);\n      parent.removeChild(preElement);\n      \n      frame.appendChild(newPre);\n      \n      // \u6DFB\u52A0\u590D\u5236\u6309\u94AE\n      const copyBtn = document.createElement('button');\n      copyBtn.className = 'copy-btn';\n      copyBtn.setAttribute('aria-label', 'Copy code');\n      copyBtn.setAttribute('type', 'button');\n      \n      const copyBtnIcon = document.createElement('div');\n      copyBtnIcon.className = 'copy-btn-icon';\n      \n      // \u590D\u5236\u56FE\u6807SVG\n      const copyIcon = document.createElementNS('http://www.w3.org/2000/svg', 'svg');\n      copyIcon.setAttribute('viewBox', '0 -960 960 960');\n      copyIcon.setAttribute('class', 'copy-btn-icon copy-icon');\n      const copyPath = document.createElementNS('http://www.w3.org/2000/svg', 'path');\n      copyPath.setAttribute('d', 'M368.37-237.37q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-474.26q0-34.48 24.26-58.74 24.26-24.26 58.74-24.26h378.26q34.48 0 58.74 24.26 24.26 24.26 24.26 58.74v474.26q0 34.48-24.26 58.74-24.26 24.26-58.74 24.26H368.37Zm0-83h378.26v-474.26H368.37v474.26Zm-155 238q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-557.26h83v557.26h461.26v83H213.37Z');\n      copyIcon.appendChild(copyPath);\n      \n      // \u6210\u529F\u56FE\u6807SVG\n      const successIcon = document.createElementNS('http://www.w3.org/2000/svg', 'svg');\n      successIcon.setAttribute('viewBox', '0 -960 960 960');\n      successIcon.setAttribute('class', 'copy-btn-icon success-icon');\n      const successPath = document.createElementNS('http://www.w3.org/2000/svg', 'path');\n      successPath.setAttribute('d', 'm389-377.13 294.7-294.7q12.58-12.67 29.52-12.67 16.93 0 29.61 12.67 12.67 12.68 12.67 29.53 0 16.86-12.28 29.14L419.07-288.41q-12.59 12.67-29.52 12.67-16.94 0-29.62-12.67L217.41-430.93q-12.67-12.68-12.79-29.45-.12-16.77 12.55-29.45 12.68-12.67 29.62-12.67 16.93 0 29.28 12.67L389-377.13Z');\n      successIcon.appendChild(successPath);\n      \n      copyBtnIcon.appendChild(copyIcon);\n      copyBtnIcon.appendChild(successIcon);\n      copyBtn.appendChild(copyBtnIcon);\n      \n      // \u590D\u5236\u529F\u80FD - \u4F7F\u7528\u4E0E\u5168\u5C40\u4E00\u81F4\u7684\u903B\u8F91\n      copyBtn.addEventListener('click', async () => {\n        try {\n          // \u83B7\u53D6\u6240\u6709.line\u5143\u7D20\u7684\u6587\u672C\u5185\u5BB9\uFF08\u4E0D\u5305\u62EC\u884C\u53F7\uFF09\n          const lineElements = newCode.querySelectorAll('.line');\n          const code = Array.from(lineElements)\n            .map(el => el.textContent)\n            .join('\\n');\n          \n          await navigator.clipboard.writeText(code);\n          copyBtn.classList.add('success');\n          \n          const timeoutId = copyBtn.getAttribute('data-timeout-id');\n          if (timeoutId) {\n            clearTimeout(parseInt(timeoutId));\n          }\n          \n          const newTimeoutId = setTimeout(() => {\n            copyBtn.classList.remove('success');\n          }, 1000);\n          \n          copyBtn.setAttribute('data-timeout-id', newTimeoutId.toString());\n        } catch (err) {\n          console.error(i18nCopyFailed, err);\n        }\n      });\n      \n      frame.appendChild(copyBtn);\n      wrapper.appendChild(frame);\n    });\n  }\n\n  // \u4E3A\u6807\u9898\u6DFB\u52A0id\u548C\u951A\u70B9\u94FE\u63A5\u7684\u51FD\u6570\n  function addHeadingAnchors(container) {\n    const headings = container.querySelectorAll('h1, h2, h3, h4, h5, h6');\n    const usedIds = new Set();\n    \n    headings.forEach(heading => {\n      // \u751F\u6210slug id\uFF08\u6A21\u62DFrehype-slug\u529F\u80FD\uFF09\n      let slug = heading.textContent\n        .toLowerCase()\n        .trim()\n        .replace(/[^\\w\\s-]/g, '') // \u79FB\u9664\u7279\u6B8A\u5B57\u7B26\n        .replace(/[\\s_-]+/g, '-') // \u66FF\u6362\u7A7A\u683C\u548C\u4E0B\u5212\u7EBF\u4E3A\u8FDE\u5B57\u7B26\n        .replace(/^-+|-+$/g, ''); // \u79FB\u9664\u5F00\u5934\u548C\u7ED3\u5C3E\u7684\u8FDE\u5B57\u7B26\n      \n      // \u786E\u4FDDid\u552F\u4E00\n      let uniqueSlug = slug;\n      let counter = 1;\n      while (usedIds.has(uniqueSlug)) {\n        uniqueSlug = `${slug}-${counter}`;\n        counter++;\n      }\n      usedIds.add(uniqueSlug);\n      \n      // \u8BBE\u7F6Eid\n      heading.id = uniqueSlug;\n      \n      // \u6DFB\u52A0\u951A\u70B9\u94FE\u63A5\uFF08\u6A21\u62DFrehype-autolink-headings\u529F\u80FD\uFF09\n      const anchor = document.createElement('span');\n      anchor.className = 'anchor-icon';\n      anchor.setAttribute('data-pagefind-ignore', 'true');\n      anchor.textContent = '#';\n      \n      const anchorWrapper = document.createElement('a');\n      anchorWrapper.className = 'anchor';\n      anchorWrapper.href = `#${uniqueSlug}`;\n      anchorWrapper.appendChild(anchor);\n      \n      // \u5C06\u951A\u70B9\u6DFB\u52A0\u5230\u6807\u9898\u672B\u5C3E\n      heading.appendChild(anchorWrapper);\n    });\n  }\n\n  async function renderMarkdownContent(markdownText) {\n    // \u52A0\u8F7Dmarked\u5E93\u7528\u4E8Emarkdown\u6E32\u67D3 - \u4F7F\u7528\u672C\u5730\u6587\u4EF6\n    if (typeof marked === 'undefined') {\n      await new Promise((resolve, reject) => {\n        const script = document.createElement('script');\n        script.src = '/assets/js/marked.min.js';\n        script.onload = resolve;\n        script.onerror = reject;\n        document.head.appendChild(script);\n      });\n    }\n    \n    // \u914D\u7F6Emarked\u7684\u57FA\u672C\u9009\u9879\n    marked.setOptions({\n      breaks: true,\n      gfm: true\n    });\n    \n    const contentDiv = document.getElementById('decrypted-content');\n    const htmlContent = marked.parse(markdownText);\n    \n    // \u521B\u5EFA\u4E0E\u6B63\u5E38\u6587\u7AE0\u5B8C\u5168\u76F8\u540C\u7684\u7ED3\u6784\n    const markdownWrapper = document.createElement('div');\n    markdownWrapper.className = 'prose dark:prose-invert prose-base !max-w-none custom-md mb-6 markdown-content onload-animation';\n    markdownWrapper.setAttribute('data-pagefind-body', '');\n    markdownWrapper.innerHTML = htmlContent;\n    \n    // \u4E3A\u6807\u9898\u6DFB\u52A0id\u548C\u951A\u70B9\u94FE\u63A5\uFF08\u6A21\u62DFrehype-slug\u548Crehype-autolink-headings\u63D2\u4EF6\u529F\u80FD\uFF09\n    addHeadingAnchors(markdownWrapper);\n    \n    // \u4E3A\u4EE3\u7801\u5757\u6DFB\u52A0\u6837\u5F0F\u548C\u529F\u80FD\uFF08\u5F02\u6B65\uFF0C\u4F7F\u7528\u4E0E\u5168\u5C40\u4E00\u81F4\u7684\u6837\u5F0F\uFF09\n    await enhanceCodeBlocks(markdownWrapper);\n    \n    // \u6E05\u7A7A\u5BB9\u5668\u5E76\u6DFB\u52A0\u65B0\u5185\u5BB9\n    contentDiv.innerHTML = '';\n    contentDiv.appendChild(markdownWrapper);\n    \n    // \u91CD\u7F6EcontentDiv\u7684\u6837\u5F0F\uFF0C\u8BA9\u5B83\u4F5C\u4E3A\u666E\u901A\u5BB9\u5668\n    contentDiv.className = '';\n    contentDiv.style.cssText = '';\n    \n    // \u89E6\u53D1TOC\u66F4\u65B0\n    const tocElement = document.querySelector('table-of-contents');\n    if (tocElement && typeof tocElement.regenerateTOC === 'function') {\n      // \u7B49\u5F85DOM\u66F4\u65B0\u540E\u91CD\u65B0\u751F\u6210TOC\n      setTimeout(() => {\n        tocElement.regenerateTOC();\n        tocElement.init();\n      }, 100);\n    }\n    \n    // \u89E6\u53D1\u79FB\u52A8\u7AEFTOC\u66F4\u65B0\n    if (typeof window.mobileTOCInit === 'function') {\n      setTimeout(() => {\n        window.mobileTOCInit();\n      }, 150);\n    }\n    \n    // \u89E6\u53D1\u52A8\u753B\u7ED3\u675F\u4E8B\u4EF6\uFF0C\u8BA9TOC\u77E5\u9053\u52A8\u753B\u5B8C\u6210\n    const animationEndEvent = new Event('animationend');\n    markdownWrapper.dispatchEvent(animationEndEvent);\n  }\n\n  async function initPasswordProtection() {\n    await loadCryptoLibraries();\n    \n    const passwordInput = document.getElementById('password-input');\n    const unlockBtn = document.getElementById('unlock-btn');\n    const errorMessage = document.getElementById('error-message');\n    const protectionDiv = document.getElementById('password-protection');\n    const contentDiv = document.getElementById('decrypted-content');\n\n    async function attemptUnlock() {\n      const inputPassword = passwordInput.value.trim();\n      \n      if (!inputPassword) {\n        showError(i18nPasswordRequired);\n        return;\n      }\n\n      unlockBtn.disabled = true;\n      unlockBtn.textContent = i18nUnlocking;\n      errorMessage.style.display = 'none';\n\n      try {\n        // \u9A8C\u8BC1\u5BC6\u7801\n        const isPasswordCorrect = bcrypt.compareSync(inputPassword, passwordHash);\n        \n        if (!isPasswordCorrect) {\n          showError(i18nIncorrect);\n          return;\n        }\n\n        // \u4F7F\u7528\u5BC6\u7801\u54C8\u5E0C\u7684\u524D32\u4E2A\u5B57\u7B26\u4F5C\u4E3A\u89E3\u5BC6\u5BC6\u94A5\uFF08\u4E0E\u670D\u52A1\u7AEF\u52A0\u5BC6\u903B\u8F91\u4E00\u81F4\uFF09\n        const encryptionKey = passwordHash.substring(0, 32);\n        \n        // \u89E3\u5BC6\u5185\u5BB9\n        const decryptedBytes = CryptoJS.AES.decrypt(encryptedContent, encryptionKey);\n        const decryptedContent = decryptedBytes.toString(CryptoJS.enc.Utf8);\n        \n        if (!decryptedContent) {\n          showError(i18nDecryptError);\n          return;\n        }\n\n        // \u6E32\u67D3markdown\u5185\u5BB9\n        await renderMarkdownContent(decryptedContent);\n        protectionDiv.style.display = 'none';\n        contentDiv.style.display = 'block';\n        \n        // \u4FDD\u5B58\u89E3\u9501\u72B6\u6001\u5230sessionStorage\uFF08\u53EF\u9009\uFF09\n        sessionStorage.setItem('page-unlocked-' + window.location.pathname, 'true');\n        \n      } catch (error) {\n        console.error(i18n(I18nKey.decryptionError), error);\n        showError(i18n(I18nKey.passwordDecryptRetry));\n      } finally {\n        unlockBtn.disabled = false;\n        unlockBtn.textContent = i18nUnlock;\n      }\n    }\n\n    function showError(message) {\n      errorMessage.textContent = message;\n      errorMessage.style.display = 'block';\n      passwordInput.focus();\n    }\n\n    // \u4E8B\u4EF6\u76D1\u542C\n    unlockBtn.addEventListener('click', attemptUnlock);\n    passwordInput.addEventListener('keypress', (e) => {\n      if (e.key === 'Enter') {\n        attemptUnlock();\n      }\n    });\n\n    // \u68C0\u67E5\u662F\u5426\u5DF2\u7ECF\u89E3\u9501\u8FC7\uFF08\u53EF\u9009\u529F\u80FD\uFF09\n    if (sessionStorage.getItem('page-unlocked-' + window.location.pathname) === 'true') {\n      passwordInput.value = 'auto-unlock';\n      // \u8FD9\u91CC\u53EF\u4EE5\u6DFB\u52A0\u81EA\u52A8\u89E3\u9501\u903B\u8F91\uFF0C\u4F46\u9700\u8981\u5B58\u50A8\u5BC6\u7801\uFF0C\u4E0D\u592A\u5B89\u5168\n    }\n\n    // \u805A\u7126\u5230\u5BC6\u7801\u8F93\u5165\u6846\n    passwordInput.focus();\n  }\n\n  // \u9875\u9762\u52A0\u8F7D\u5B8C\u6210\u540E\u521D\u59CB\u5316\n  if (document.readyState === 'loading') {\n    document.addEventListener('DOMContentLoaded', initPasswordProtection);\n  } else {\n    initPasswordProtection();\n  }\n})();<\/script>"], ["", '<div id="password-protection" class="password-protection" data-astro-cid-732embm3> <div class="password-container" data-astro-cid-732embm3> <div class="lock-icon" data-astro-cid-732embm3> <svg width="48" height="48" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" data-astro-cid-732embm3> <path d="M18 8h-1V6c0-2.76-2.24-5-5-5S7 3.24 7 6v2H6c-1.1 0-2 .9-2 2v10c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V10c0-1.1-.9-2-2-2zM9 6c0-1.66 1.34-3 3-3s3 1.34 3 3v2H9V6z" fill="currentColor" data-astro-cid-732embm3></path> </svg> </div> <h2 data-astro-cid-732embm3>', "</h2> <p data-astro-cid-732embm3>", '</p> <div class="password-input-group" data-astro-cid-732embm3> <input type="password" id="password-input"', ' class="password-input" data-astro-cid-732embm3> <button id="unlock-btn" class="unlock-button" data-astro-cid-732embm3>', '</button> </div> <div id="error-message" class="error-message" style="display: none;" data-astro-cid-732embm3>', '</div> </div> </div> <div id="decrypted-content" class="decrypted-content" style="display: none;" data-astro-cid-732embm3></div>  <script>(function(){', "\n  // \u5BFC\u5165\u52A0\u5BC6\u5E93 - \u4F7F\u7528\u672C\u5730\u6587\u4EF6\n  async function loadCryptoLibraries() {\n    if (typeof CryptoJS === 'undefined') {\n      await new Promise((resolve, reject) => {\n        const script = document.createElement('script');\n        script.src = '/assets/js/crypto-js.min.js';\n        script.onload = resolve;\n        script.onerror = reject;\n        document.head.appendChild(script);\n      });\n    }\n    \n    if (typeof bcrypt === 'undefined') {\n      await new Promise((resolve, reject) => {\n        const script = document.createElement('script');\n        script.src = '/assets/js/bcrypt.min.js';\n        script.onload = resolve;\n        script.onerror = reject;\n        document.head.appendChild(script);\n      });\n    }\n  }\n\n  // \u52A0\u8F7D\u8BED\u6CD5\u9AD8\u4EAE\u5E93\n  async function loadSyntaxHighlighter() {\n    if (typeof hljs === 'undefined') {\n      await new Promise((resolve, reject) => {\n        const script = document.createElement('script');\n        script.src = '/assets/js/highlight.min.js';\n        script.onload = resolve;\n        script.onerror = reject;\n        document.head.appendChild(script);\n      });\n      await new Promise(resolve => setTimeout(resolve, 100));\n    }\n  }\n\n  // \u4E3A\u4EE3\u7801\u5757\u6DFB\u52A0\u6837\u5F0F\u548C\u529F\u80FD\u7684\u51FD\u6570 - \u4F7F\u7528highlight.js\u8FDB\u884C\u8BED\u6CD5\u9AD8\u4EAE\uFF0C\u4F46\u4F7F\u7528\u5168\u5C40expressive-code\u6837\u5F0F\n  async function enhanceCodeBlocks(container) {\n    // \u52A0\u8F7D\u8BED\u6CD5\u9AD8\u4EAE\u5E93\n    await loadSyntaxHighlighter();\n    \n    const codeBlocks = container.querySelectorAll('pre code');\n    \n    codeBlocks.forEach(codeElement => {\n      const preElement = codeElement.parentElement;\n      if (!preElement) return;\n      \n      // \u83B7\u53D6\u8BED\u8A00\u4FE1\u606F\n      const className = codeElement.className || '';\n      const langMatch = className.match(/language-(\\\\w+)/);\n      const language = langMatch ? langMatch[1] : 'text';\n      \n      // \u83B7\u53D6\u539F\u59CB\u4EE3\u7801\u6587\u672C\n      const codeText = codeElement.textContent || '';\n      \n      // \u4F7F\u7528 highlight.js \u8FDB\u884C\u8BED\u6CD5\u9AD8\u4EAE\n      let highlightedCode = codeText;\n      if (typeof hljs !== 'undefined') {\n        try {\n          if (language && language !== 'text') {\n            const result = hljs.highlight(codeText, { language: language });\n            highlightedCode = result.value;\n          } else {\n            const result = hljs.highlightAuto(codeText);\n            highlightedCode = result.value;\n          }\n        } catch (e) {\n          console.warn('Syntax highlight failed:', e);\n          highlightedCode = codeText;\n        }\n      }\n      \n      // \u521B\u5EFAexpressive-code\u6837\u5F0F\u7684\u5305\u88C5\u7ED3\u6784\n      const wrapper = document.createElement('div');\n      wrapper.className = 'expressive-code';\n      \n      const frame = document.createElement('div');\n      frame.className = 'frame';\n      \n      // \u521B\u5EFA\u65B0\u7684pre\u5143\u7D20\n      const newPre = document.createElement('pre');\n      newPre.className = 'astro-code';\n      newPre.setAttribute('data-language', language);\n      newPre.setAttribute('tabindex', '0');\n      \n      // \u521B\u5EFA\u65B0\u7684code\u5143\u7D20\n      const newCode = document.createElement('code');\n      newCode.className = \\`language-\\${language}\\`;\n      \n      // \u5C06\u9AD8\u4EAE\u540E\u7684\u4EE3\u7801\u6309\u884C\u5206\u5272\u5E76\u6DFB\u52A0.line\u7C7B\uFF08\u6A21\u62DFexpressive-code\u7684\u884C\u7ED3\u6784\uFF09\n      const lines = highlightedCode.split('\\\\n');\n      lines.forEach((line, index) => {\n        const lineSpan = document.createElement('span');\n        lineSpan.className = 'line';\n        lineSpan.innerHTML = line || ' '; // \u7A7A\u884C\u4E5F\u8981\u4FDD\u7559\n        newCode.appendChild(lineSpan);\n        \n        // \u9664\u4E86\u6700\u540E\u4E00\u884C\uFF0C\u90FD\u6DFB\u52A0\u6362\u884C\u7B26\n        if (index < lines.length - 1) {\n          newCode.appendChild(document.createTextNode('\\\\n'));\n        }\n      });\n      \n      newPre.appendChild(newCode);\n      \n      // \u5C06 pre \u4ECE\u539F\u4F4D\u7F6E\u79FB\u9664\u5E76\u91CD\u65B0\u5305\u88C5\n      const parent = preElement.parentNode;\n      parent.insertBefore(wrapper, preElement);\n      parent.removeChild(preElement);\n      \n      frame.appendChild(newPre);\n      \n      // \u6DFB\u52A0\u590D\u5236\u6309\u94AE\n      const copyBtn = document.createElement('button');\n      copyBtn.className = 'copy-btn';\n      copyBtn.setAttribute('aria-label', 'Copy code');\n      copyBtn.setAttribute('type', 'button');\n      \n      const copyBtnIcon = document.createElement('div');\n      copyBtnIcon.className = 'copy-btn-icon';\n      \n      // \u590D\u5236\u56FE\u6807SVG\n      const copyIcon = document.createElementNS('http://www.w3.org/2000/svg', 'svg');\n      copyIcon.setAttribute('viewBox', '0 -960 960 960');\n      copyIcon.setAttribute('class', 'copy-btn-icon copy-icon');\n      const copyPath = document.createElementNS('http://www.w3.org/2000/svg', 'path');\n      copyPath.setAttribute('d', 'M368.37-237.37q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-474.26q0-34.48 24.26-58.74 24.26-24.26 58.74-24.26h378.26q34.48 0 58.74 24.26 24.26 24.26 24.26 58.74v474.26q0 34.48-24.26 58.74-24.26 24.26-58.74 24.26H368.37Zm0-83h378.26v-474.26H368.37v474.26Zm-155 238q-34.48 0-58.74-24.26-24.26-24.26-24.26-58.74v-557.26h83v557.26h461.26v83H213.37Z');\n      copyIcon.appendChild(copyPath);\n      \n      // \u6210\u529F\u56FE\u6807SVG\n      const successIcon = document.createElementNS('http://www.w3.org/2000/svg', 'svg');\n      successIcon.setAttribute('viewBox', '0 -960 960 960');\n      successIcon.setAttribute('class', 'copy-btn-icon success-icon');\n      const successPath = document.createElementNS('http://www.w3.org/2000/svg', 'path');\n      successPath.setAttribute('d', 'm389-377.13 294.7-294.7q12.58-12.67 29.52-12.67 16.93 0 29.61 12.67 12.67 12.68 12.67 29.53 0 16.86-12.28 29.14L419.07-288.41q-12.59 12.67-29.52 12.67-16.94 0-29.62-12.67L217.41-430.93q-12.67-12.68-12.79-29.45-.12-16.77 12.55-29.45 12.68-12.67 29.62-12.67 16.93 0 29.28 12.67L389-377.13Z');\n      successIcon.appendChild(successPath);\n      \n      copyBtnIcon.appendChild(copyIcon);\n      copyBtnIcon.appendChild(successIcon);\n      copyBtn.appendChild(copyBtnIcon);\n      \n      // \u590D\u5236\u529F\u80FD - \u4F7F\u7528\u4E0E\u5168\u5C40\u4E00\u81F4\u7684\u903B\u8F91\n      copyBtn.addEventListener('click', async () => {\n        try {\n          // \u83B7\u53D6\u6240\u6709.line\u5143\u7D20\u7684\u6587\u672C\u5185\u5BB9\uFF08\u4E0D\u5305\u62EC\u884C\u53F7\uFF09\n          const lineElements = newCode.querySelectorAll('.line');\n          const code = Array.from(lineElements)\n            .map(el => el.textContent)\n            .join('\\\\n');\n          \n          await navigator.clipboard.writeText(code);\n          copyBtn.classList.add('success');\n          \n          const timeoutId = copyBtn.getAttribute('data-timeout-id');\n          if (timeoutId) {\n            clearTimeout(parseInt(timeoutId));\n          }\n          \n          const newTimeoutId = setTimeout(() => {\n            copyBtn.classList.remove('success');\n          }, 1000);\n          \n          copyBtn.setAttribute('data-timeout-id', newTimeoutId.toString());\n        } catch (err) {\n          console.error(i18nCopyFailed, err);\n        }\n      });\n      \n      frame.appendChild(copyBtn);\n      wrapper.appendChild(frame);\n    });\n  }\n\n  // \u4E3A\u6807\u9898\u6DFB\u52A0id\u548C\u951A\u70B9\u94FE\u63A5\u7684\u51FD\u6570\n  function addHeadingAnchors(container) {\n    const headings = container.querySelectorAll('h1, h2, h3, h4, h5, h6');\n    const usedIds = new Set();\n    \n    headings.forEach(heading => {\n      // \u751F\u6210slug id\uFF08\u6A21\u62DFrehype-slug\u529F\u80FD\uFF09\n      let slug = heading.textContent\n        .toLowerCase()\n        .trim()\n        .replace(/[^\\\\w\\\\s-]/g, '') // \u79FB\u9664\u7279\u6B8A\u5B57\u7B26\n        .replace(/[\\\\s_-]+/g, '-') // \u66FF\u6362\u7A7A\u683C\u548C\u4E0B\u5212\u7EBF\u4E3A\u8FDE\u5B57\u7B26\n        .replace(/^-+|-+$/g, ''); // \u79FB\u9664\u5F00\u5934\u548C\u7ED3\u5C3E\u7684\u8FDE\u5B57\u7B26\n      \n      // \u786E\u4FDDid\u552F\u4E00\n      let uniqueSlug = slug;\n      let counter = 1;\n      while (usedIds.has(uniqueSlug)) {\n        uniqueSlug = \\`\\${slug}-\\${counter}\\`;\n        counter++;\n      }\n      usedIds.add(uniqueSlug);\n      \n      // \u8BBE\u7F6Eid\n      heading.id = uniqueSlug;\n      \n      // \u6DFB\u52A0\u951A\u70B9\u94FE\u63A5\uFF08\u6A21\u62DFrehype-autolink-headings\u529F\u80FD\uFF09\n      const anchor = document.createElement('span');\n      anchor.className = 'anchor-icon';\n      anchor.setAttribute('data-pagefind-ignore', 'true');\n      anchor.textContent = '#';\n      \n      const anchorWrapper = document.createElement('a');\n      anchorWrapper.className = 'anchor';\n      anchorWrapper.href = \\`#\\${uniqueSlug}\\`;\n      anchorWrapper.appendChild(anchor);\n      \n      // \u5C06\u951A\u70B9\u6DFB\u52A0\u5230\u6807\u9898\u672B\u5C3E\n      heading.appendChild(anchorWrapper);\n    });\n  }\n\n  async function renderMarkdownContent(markdownText) {\n    // \u52A0\u8F7Dmarked\u5E93\u7528\u4E8Emarkdown\u6E32\u67D3 - \u4F7F\u7528\u672C\u5730\u6587\u4EF6\n    if (typeof marked === 'undefined') {\n      await new Promise((resolve, reject) => {\n        const script = document.createElement('script');\n        script.src = '/assets/js/marked.min.js';\n        script.onload = resolve;\n        script.onerror = reject;\n        document.head.appendChild(script);\n      });\n    }\n    \n    // \u914D\u7F6Emarked\u7684\u57FA\u672C\u9009\u9879\n    marked.setOptions({\n      breaks: true,\n      gfm: true\n    });\n    \n    const contentDiv = document.getElementById('decrypted-content');\n    const htmlContent = marked.parse(markdownText);\n    \n    // \u521B\u5EFA\u4E0E\u6B63\u5E38\u6587\u7AE0\u5B8C\u5168\u76F8\u540C\u7684\u7ED3\u6784\n    const markdownWrapper = document.createElement('div');\n    markdownWrapper.className = 'prose dark:prose-invert prose-base !max-w-none custom-md mb-6 markdown-content onload-animation';\n    markdownWrapper.setAttribute('data-pagefind-body', '');\n    markdownWrapper.innerHTML = htmlContent;\n    \n    // \u4E3A\u6807\u9898\u6DFB\u52A0id\u548C\u951A\u70B9\u94FE\u63A5\uFF08\u6A21\u62DFrehype-slug\u548Crehype-autolink-headings\u63D2\u4EF6\u529F\u80FD\uFF09\n    addHeadingAnchors(markdownWrapper);\n    \n    // \u4E3A\u4EE3\u7801\u5757\u6DFB\u52A0\u6837\u5F0F\u548C\u529F\u80FD\uFF08\u5F02\u6B65\uFF0C\u4F7F\u7528\u4E0E\u5168\u5C40\u4E00\u81F4\u7684\u6837\u5F0F\uFF09\n    await enhanceCodeBlocks(markdownWrapper);\n    \n    // \u6E05\u7A7A\u5BB9\u5668\u5E76\u6DFB\u52A0\u65B0\u5185\u5BB9\n    contentDiv.innerHTML = '';\n    contentDiv.appendChild(markdownWrapper);\n    \n    // \u91CD\u7F6EcontentDiv\u7684\u6837\u5F0F\uFF0C\u8BA9\u5B83\u4F5C\u4E3A\u666E\u901A\u5BB9\u5668\n    contentDiv.className = '';\n    contentDiv.style.cssText = '';\n    \n    // \u89E6\u53D1TOC\u66F4\u65B0\n    const tocElement = document.querySelector('table-of-contents');\n    if (tocElement && typeof tocElement.regenerateTOC === 'function') {\n      // \u7B49\u5F85DOM\u66F4\u65B0\u540E\u91CD\u65B0\u751F\u6210TOC\n      setTimeout(() => {\n        tocElement.regenerateTOC();\n        tocElement.init();\n      }, 100);\n    }\n    \n    // \u89E6\u53D1\u79FB\u52A8\u7AEFTOC\u66F4\u65B0\n    if (typeof window.mobileTOCInit === 'function') {\n      setTimeout(() => {\n        window.mobileTOCInit();\n      }, 150);\n    }\n    \n    // \u89E6\u53D1\u52A8\u753B\u7ED3\u675F\u4E8B\u4EF6\uFF0C\u8BA9TOC\u77E5\u9053\u52A8\u753B\u5B8C\u6210\n    const animationEndEvent = new Event('animationend');\n    markdownWrapper.dispatchEvent(animationEndEvent);\n  }\n\n  async function initPasswordProtection() {\n    await loadCryptoLibraries();\n    \n    const passwordInput = document.getElementById('password-input');\n    const unlockBtn = document.getElementById('unlock-btn');\n    const errorMessage = document.getElementById('error-message');\n    const protectionDiv = document.getElementById('password-protection');\n    const contentDiv = document.getElementById('decrypted-content');\n\n    async function attemptUnlock() {\n      const inputPassword = passwordInput.value.trim();\n      \n      if (!inputPassword) {\n        showError(i18nPasswordRequired);\n        return;\n      }\n\n      unlockBtn.disabled = true;\n      unlockBtn.textContent = i18nUnlocking;\n      errorMessage.style.display = 'none';\n\n      try {\n        // \u9A8C\u8BC1\u5BC6\u7801\n        const isPasswordCorrect = bcrypt.compareSync(inputPassword, passwordHash);\n        \n        if (!isPasswordCorrect) {\n          showError(i18nIncorrect);\n          return;\n        }\n\n        // \u4F7F\u7528\u5BC6\u7801\u54C8\u5E0C\u7684\u524D32\u4E2A\u5B57\u7B26\u4F5C\u4E3A\u89E3\u5BC6\u5BC6\u94A5\uFF08\u4E0E\u670D\u52A1\u7AEF\u52A0\u5BC6\u903B\u8F91\u4E00\u81F4\uFF09\n        const encryptionKey = passwordHash.substring(0, 32);\n        \n        // \u89E3\u5BC6\u5185\u5BB9\n        const decryptedBytes = CryptoJS.AES.decrypt(encryptedContent, encryptionKey);\n        const decryptedContent = decryptedBytes.toString(CryptoJS.enc.Utf8);\n        \n        if (!decryptedContent) {\n          showError(i18nDecryptError);\n          return;\n        }\n\n        // \u6E32\u67D3markdown\u5185\u5BB9\n        await renderMarkdownContent(decryptedContent);\n        protectionDiv.style.display = 'none';\n        contentDiv.style.display = 'block';\n        \n        // \u4FDD\u5B58\u89E3\u9501\u72B6\u6001\u5230sessionStorage\uFF08\u53EF\u9009\uFF09\n        sessionStorage.setItem('page-unlocked-' + window.location.pathname, 'true');\n        \n      } catch (error) {\n        console.error(i18n(I18nKey.decryptionError), error);\n        showError(i18n(I18nKey.passwordDecryptRetry));\n      } finally {\n        unlockBtn.disabled = false;\n        unlockBtn.textContent = i18nUnlock;\n      }\n    }\n\n    function showError(message) {\n      errorMessage.textContent = message;\n      errorMessage.style.display = 'block';\n      passwordInput.focus();\n    }\n\n    // \u4E8B\u4EF6\u76D1\u542C\n    unlockBtn.addEventListener('click', attemptUnlock);\n    passwordInput.addEventListener('keypress', (e) => {\n      if (e.key === 'Enter') {\n        attemptUnlock();\n      }\n    });\n\n    // \u68C0\u67E5\u662F\u5426\u5DF2\u7ECF\u89E3\u9501\u8FC7\uFF08\u53EF\u9009\u529F\u80FD\uFF09\n    if (sessionStorage.getItem('page-unlocked-' + window.location.pathname) === 'true') {\n      passwordInput.value = 'auto-unlock';\n      // \u8FD9\u91CC\u53EF\u4EE5\u6DFB\u52A0\u81EA\u52A8\u89E3\u9501\u903B\u8F91\uFF0C\u4F46\u9700\u8981\u5B58\u50A8\u5BC6\u7801\uFF0C\u4E0D\u592A\u5B89\u5168\n    }\n\n    // \u805A\u7126\u5230\u5BC6\u7801\u8F93\u5165\u6846\n    passwordInput.focus();\n  }\n\n  // \u9875\u9762\u52A0\u8F7D\u5B8C\u6210\u540E\u521D\u59CB\u5316\n  if (document.readyState === 'loading') {\n    document.addEventListener('DOMContentLoaded', initPasswordProtection);\n  } else {\n    initPasswordProtection();\n  }\n})();<\/script>"])), maybeRenderHead(), i18n(I18nKey.passwordProtectedTitle), i18n(I18nKey.passwordProtectedDescription), addAttribute(i18n(I18nKey.passwordPlaceholder), "placeholder"), i18n(I18nKey.passwordUnlock), i18n(I18nKey.passwordIncorrect), defineScriptVars({
    encryptedContent,
    passwordHash,
    i18nUnlocking: i18n(I18nKey.passwordUnlocking),
    i18nIncorrect: i18n(I18nKey.passwordIncorrect),
    i18nDecryptError: i18n(I18nKey.passwordDecryptError),
    i18nUnlock: i18n(I18nKey.passwordUnlock),
    i18nCopyFailed: i18n(I18nKey.copyFailed),
    i18nPasswordRequired: i18n(I18nKey.passwordRequired),
    i18nDecryptionError: i18n(I18nKey.decryptionError),
    i18nPasswordDecryptRetry: i18n(I18nKey.passwordDecryptRetry)
  }));
}, "D:/lyf/blog/my_blog/src/components/PasswordProtection.astro", void 0);

export { $$PasswordProtection as default };
